{% extends 'base_site.html' %}

{% block content %}
{% if projects %}
<section>
    {% for project in projects %}
        {% include 'inventory/_card.html' with name=project.name location=project.get_absolute_url slot="count" count=project.get_rolls_remaining %}
    {% endfor %}
</section>
{% endif %}

{% if rolls_loaded %}
<section>
    <h2 class="c-heading">Loaded Cameras</h2>
    {% for roll in rolls_loaded %}
        {% include 'inventory/_card.html' with name=roll.camera.name location=roll.camera.get_absolute_url slot="reminder" roll=roll %}
    {% endfor %}
</section>
{% endif %}

{% if cameras_empty %}
<section>
    <h2 class="c-heading">Ready to Load</h2>
    {% for camera in cameras_empty %}
        {% url 'camera-load' camera.id as camera_load %}
        {% include 'inventory/_card.html' with name=camera.name location=camera_load slot="reminder" %}
    {% endfor %}
</section>
{% endif %}

<section>
    <h2 class="c-heading">Inventory</h2>
    {% url 'ready' as ready_url %}
    {% url 'dashboard' as dashboard_url %}
    {% url 'profile' as profile_url %}

    {% include 'inventory/_card.html' with name='Ready to process' location=ready_url slot="count" count=rolls_ready_count %}
    {% include 'inventory/_card.html' with name='Still outstanding' location=dashboard_url slot="count" count=rolls_outstanding_count %}
    {% include 'inventory/_card.html' with name='In storage' location=profile_url slot="count" count=rolls_storage_count %}
</section>

<section>
    <h2 class="c-heading">Add to your database</h2>
    <div class="raw">
        <h3>Add film</h3>
        <form action="{% url 'rolls-add' %}" method="post">
            {% csrf_token %}
            <select name="film" required>
                <option value="">Select a film</option>
                {% regroup films by manufacturer as films_list %}
                {% for manufacturer in films_list %}
                <optgroup label="{{ manufacturer.grouper }}">
                    {% for film in manufacturer.list %}
                    <option value="{{ film.id }}">{{ film.name }} in {{ film.get_format_display }}</option>
                    {% endfor %}
                </optgroup>
                {% endfor %}
            </select>
            <input type="number" min="1" name="quantity" placeholder="quantity" required />
            <input type="submit" value="Add" />
        </form>

        <h3><a href="{% url 'camera-add' %}">Add a camera</a></h3>
        <h3><a href="{% url 'project-add' %}">Add a project</a></h3>
</div>
</section>
{% endblock %}
