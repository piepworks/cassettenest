{% extends 'base_site.html' %}

{% block title %} / Load {{ camera.name }}{% endblock %}

{% block content %}
<h2>{{ camera.name }}</h2>
<p><a href="{% url 'camera-edit' camera.id %}">Edit this camera</a></p>

{% if camera.status != 'loaded' %}
<h3>Pick a film to load:</h3>

<p>Format: {{ camera.get_format_display }}</p>

{% if projects %}
<p>Filter by Project:</p>
<form method="get">
    {% if iso_range and iso_value %}
    <input type="hidden" name="iso_range" value="{{ iso_range }}" />
    <input type="hidden" name="iso_value" value="{{ iso_value }}" />
    {% endif %}
    <select name="project">
        <option value="0">All rolls</option>
        {% for project in projects %}
        <option value="{{ project.id }}" {% if project.id == current_project.id %}selected{% endif %}>
            {{ project.name }}
        </option>
        {% endfor %}
    </select>
    <input type="submit" value="Filter" />
</form>
<p>Showing: {{ current_project.name|default:"All rolls" }}</p>
{% endif %}

<p>Filter by ISO</p>
<form method="get">
    {% if current_project %}
    <input type="hidden" name="project" value="{{ current_project.id }}" />
    {% endif %}
    <select name="iso_range" required>
        <option value="0">All ISOs</option>
        <option value="lte" {% if iso_range == 'lte' %}selected{% endif %}>&lt;= Less than or equal to</option>
        <option value="gte" {% if iso_range == 'gte' %}selected{% endif %}>&gt;= Greater than or equal to</option>
        <option value="equals" {% if iso_range == 'equals' %}selected{% endif %}>= Equal to</option>
    </select>
    <input type="number" name="iso_value" placeholder="ISO" value="{{ iso_value }}" required />
    <input type="submit" value="Filter" />
</form>
{% if iso_range and iso_value %}
<p>Showing: ISO
    {% ifequal iso_range 'gte' %}greater than or equal to{% endifequal %}
    {% ifequal iso_range 'lte' %}less than or equal to{% endifequal %}
    {% ifequal iso_range 'equals' %}equal to{% endifequal %}
{{ iso_value }}</p>
{% else %}
<p>Showing: All ISOs</p>
{% endif %}

<hr />

{% if film_counts %}
<form method="post">
    {% csrf_token %}
    {% regroup film_counts by get_type_display as film_list %}
    <select name="film">
        <option value="">Select a film</option>
        {% for type in film_list %}
        <optgroup label="{{ type.grouper }}">
            {% for film in type.list %}
            <option value="{{ film.id }}">{{ film.manufacturer }} {{ film.name }} ({{ film.count }})</option>
            {% endfor %}
        </optgroup>
        {% endfor %}
    </select>
    <select name="push_pull">
        <option value="">Push/Pull</option>
        <option value="-2">Pull 2 stops</option>
        <option value="-1">Pull 1 stop</option>
        <option value="+1">Push 1 stop</option>
        <option value="+2">Push 2 stops</option>
        <option value="+3">Push 3 stops</option>
    </select>
    <input type="submit" value="Load camera" />
</form>
{% else %}
<p>No film to load.</p>
{% endif %}

{% else %}
<p><a href="{% url 'camera-detail' camera.id %}">This camera</a> is already loaded.</p>
{% endif %}

{% endblock %}
